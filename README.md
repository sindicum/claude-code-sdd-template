# Claude Code による Spec Driven Development（スペック駆動開発）テンプレート

書籍「実践 Claude Code 入門（技術評論社）」をベースに [cc-sdd](https://github.com/gotalab/cc-sdd) の考え方も取り入れ改変・再構築。

---

## サブエージェント・スキル・コマンド利用の基本的な考え方

### サブエージェント（Agents）= 「独立した検証・分析」

- 大量ファイル読み込み・専門検証を親コンテキストから分離
- 詳細な結果を親エージェントに返却
- 例: doc-reviewer, implementation-validator

### スキル（Skills）= 「やり方」

- 具体的な作業の実行方法を定義
- プロジェクト固有のルール・知識を蓄積
- 例: prd-writing, steering, architecture-design

### コマンド（Commands）= 「流れ」

- 複数のスキルを順序立てて実行
- 定型的な作業手順を自動化
- 例: /setup-project, /add-feature

### まとめ

| 種別             | 追加基準                                     |
| ---------------- | -------------------------------------------- |
| サブエージェント | 大量読み込み・親コンテキスト分離が必要な検証 |
| スキル           | 成果物単位・タスク単位・ドメイン単位の知識   |
| コマンド         | 「毎回同じ手順を踏む」定型作業               |

---

## サブエージェント（.claude/agents/）

親エージェントのコンテキストを圧迫せずに、独立した検証・分析を実行する。

### doc-reviewer

| 項目       | 内容                                                                                  |
| ---------- | ------------------------------------------------------------------------------------- |
| **目的**   | ドキュメントの品質評価と改善提案                                                      |
| **モデル** | Sonnet                                                                                |
| **対象**   | PRD、機能設計書、アーキテクチャ設計書、リポジトリ構造定義書、開発ガイドライン、用語集 |

**評価観点**:

1. **完全性**: 必要なセクションが全て含まれているか
2. **明確性**: 用語の一貫性、定義の明確さ
3. **一貫性**: 他ドキュメントとの矛盾がないか
4. **実装可能性**: 開発者が実装に必要な情報が揃っているか
5. **測定可能性**: 成功基準が測定可能か

**出力形式**:

- 総合評価（5 段階スコア）
- 良い点（最低 3 つ）
- 改善が必要な点（必須/推奨/提案の優先度別）
- 次のステップ

---

### implementation-validator

| 項目       | 内容                                     |
| ---------- | ---------------------------------------- |
| **目的**   | 実装コードの品質検証とスペック整合性確認 |
| **モデル** | Sonnet                                   |
| **対象**   | 実装コード全般                           |

**検証観点**:

1. **スペック準拠**: PRD・機能設計・アーキテクチャとの整合性
2. **コード品質**: コーディング規約、命名、単一責務
3. **テストカバレッジ**: ユニットテスト、エッジケース（目標 80%以上）
4. **セキュリティ**: 入力検証、機密情報管理、認証・認可
5. **パフォーマンス**: データ構造、ループ最適化、メモリリーク

**実行ツール**:

- `npm run lint`
- `npm run typecheck`
- `npm test`
- `npm run build`

---

## スキル（.claude/skills/）

具体的な作業の実行方法を定義し、プロジェクト固有のルール・知識を蓄積する。

### steering

| 項目           | 内容                                 |
| -------------- | ------------------------------------ |
| **目的**       | ステアリングファイルの作成と進捗管理 |
| **許可ツール** | Read, Write                          |
| **出力先**     | `.steering/[YYYYMMDD]-[機能名]/`     |

**3 つのモード**:

| モード             | 用途                     | 成果物                                  |
| ------------------ | ------------------------ | --------------------------------------- |
| モード 1: 作成     | ステアリングファイル作成 | requirements.md, design.md, tasklist.md |
| モード 2: 実装     | タスク進捗管理           | tasklist.md の `[ ]` → `[x]` 更新       |
| モード 3: 振り返り | 実装完了後の記録         | 振り返りセクション更新                  |

**重要な原則**:

- tasklist.md の全タスク完了が必須
- タスクスキップは技術的理由のみ許可
- TodoWrite は補助、tasklist.md が正式記録

---

### prd-writing

| 項目           | 内容                              |
| -------------- | --------------------------------- |
| **目的**       | プロダクト要求定義書（PRD）の作成 |
| **許可ツール** | Read, Write                       |
| **出力先**     | `docs/product-requirements.md`    |

**PRD に含めるもの**:

- プロダクトの概要と目的
- 前提条件・制約条件
- 機能要件（MVP/将来）
- 非機能要件
- スコープ外

**優先度の定義**:

- **P0（必須）**: MVP に含める機能
- **P1（重要）**: 初期リリース後に追加
- **P2（できれば）**: 将来的に検討

---

### functional-design

| 項目           | 内容                        |
| -------------- | --------------------------- |
| **目的**       | 機能設計書の作成            |
| **許可ツール** | Read, Write                 |
| **出力先**     | `docs/functional-design.md` |
| **前提条件**   | PRD が存在すること          |

**含まれる内容**:

- システム構成図
- データモデル
- ユースケース（シーケンス図）
- エラーハンドリング
- API 設計

---

### architecture-design

| 項目           | 内容                          |
| -------------- | ----------------------------- |
| **目的**       | アーキテクチャ設計書の作成    |
| **許可ツール** | Read, Write                   |
| **出力先**     | `docs/architecture.md`        |
| **前提条件**   | PRD、機能設計書が存在すること |

**含まれる内容**:

- システム構造
- 技術スタック（選定理由付き）
- レイヤードアーキテクチャ
- パフォーマンス要件
- セキュリティ考慮事項
- スケーラビリティ

---

### repository-structure

| 項目           | 内容                                                |
| -------------- | --------------------------------------------------- |
| **目的**       | リポジトリ構造定義書の作成                          |
| **許可ツール** | Read, Write                                         |
| **出力先**     | `docs/repository-structure.md`                      |
| **前提条件**   | PRD、機能設計書、アーキテクチャ設計書が存在すること |

**含まれる内容**:

- ディレクトリ構造（ツリー形式）
- 各ディレクトリの役割
- 命名規則
- 依存関係のルール
- スケーリング戦略

---

### development-guidelines

| 項目           | 内容                                                       |
| -------------- | ---------------------------------------------------------- |
| **目的**       | 開発ガイドラインの作成                                     |
| **許可ツール** | Read, Write, Edit                                          |
| **出力先**     | `docs/development-guidelines.md`                           |
| **前提条件**   | アーキテクチャ設計書、リポジトリ構造が存在すること（推奨） |

**2 つのサブガイド**:

| ガイド              | 内容                                                              |
| ------------------- | ----------------------------------------------------------------- |
| `implementation.md` | コーディング規約、命名規則、エラーハンドリング、テストコード      |
| `process.md`        | Git 運用（Git Flow）、コミットメッセージ、PR プロセス、テスト戦略 |

---

### glossary-creation

| 項目           | 内容                                     |
| -------------- | ---------------------------------------- |
| **目的**       | 用語集（ユビキタス言語）の作成           |
| **許可ツール** | Read, Write                              |
| **出力先**     | `docs/glossary.md`                       |
| **前提条件**   | 他の全ドキュメントが存在すること（推奨） |

**含まれる内容**:

- プロジェクト固有の用語定義
- 技術用語の定義
- 具体例
- 関連用語のリンク

---

## 依存関係図

```
prd-writing
    ↓
functional-design
    ↓
architecture-design
    ↓
repository-structure
    ↓
development-guidelines
    ↓
glossary-creation
```

**補足**:

- 上位のドキュメントが存在しないと、下位のスキルは実行不可または不完全になる
- `/setup-project` コマンドはこの順序で 6 つのドキュメントを作成する

---

## コマンドとの関係

| コマンド           | 使用するスキル/エージェント                                                                                               |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------- |
| `/setup-project`   | prd-writing → architecture-design → functional-design → repository-structure → development-guidelines → glossary-creation |
| `/add-feature`     | steering + implementation-validator                                                                                       |
| `/review-docs`     | doc-reviewer                                                                                                              |
| `/status`          | （tasklist.md の読み込みのみ）                                                                                            |
| `/validate-design` | doc-reviewer                                                                                                              |
| `/validate-gap`    | implementation-validator                                                                                                  |
